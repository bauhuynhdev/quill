{"version":3,"file":"createRegistryWithFormats.js","names":["Registry","MAX_REGISTER_ITERATIONS","CORE_FORMATS","createRegistryWithFormats","formats","sourceRegistry","debug","registry","forEach","name","coreBlot","query","register","format","error","iterations","requiredContainer"],"sources":["../../../src/core/utils/createRegistryWithFormats.ts"],"sourcesContent":["import { Registry } from 'parchment';\r\n\r\nconst MAX_REGISTER_ITERATIONS = 100;\r\nconst CORE_FORMATS = ['block', 'break', 'cursor', 'inline', 'scroll', 'text'];\r\n\r\nconst createRegistryWithFormats = (\r\n  formats: string[],\r\n  sourceRegistry: Registry,\r\n  debug: { error: (errorMessage: string) => void },\r\n) => {\r\n  const registry = new Registry();\r\n  CORE_FORMATS.forEach((name) => {\r\n    const coreBlot = sourceRegistry.query(name);\r\n    if (coreBlot) registry.register(coreBlot);\r\n  });\r\n\r\n  formats.forEach((name) => {\r\n    let format = sourceRegistry.query(name);\r\n    if (!format) {\r\n      debug.error(\r\n        `Cannot register \"${name}\" specified in \"formats\" config. Are you sure it was registered?`,\r\n      );\r\n    }\r\n    let iterations = 0;\r\n    while (format) {\r\n      registry.register(format);\r\n      format = 'blotName' in format ? format.requiredContainer ?? null : null;\r\n\r\n      iterations += 1;\r\n      if (iterations > MAX_REGISTER_ITERATIONS) {\r\n        debug.error(\r\n          `Cycle detected in registering blot requiredContainer: \"${name}\"`,\r\n        );\r\n        break;\r\n      }\r\n    }\r\n  });\r\n\r\n  return registry;\r\n};\r\n\r\nexport default createRegistryWithFormats;\r\n"],"mappings":"AAAA,SAASA,QAAQ,QAAQ,WAAW;AAEpC,MAAMC,uBAAuB,GAAG,GAAG;AACnC,MAAMC,YAAY,GAAG,CAAC,OAAO,EAAE,OAAO,EAAE,QAAQ,EAAE,QAAQ,EAAE,QAAQ,EAAE,MAAM,CAAC;AAE7E,MAAMC,yBAAyB,GAAGA,CAChCC,OAAiB,EACjBC,cAAwB,EACxBC,KAAgD,KAC7C;EACH,MAAMC,QAAQ,GAAG,IAAIP,QAAQ,CAAC,CAAC;EAC/BE,YAAY,CAACM,OAAO,CAAEC,IAAI,IAAK;IAC7B,MAAMC,QAAQ,GAAGL,cAAc,CAACM,KAAK,CAACF,IAAI,CAAC;IAC3C,IAAIC,QAAQ,EAAEH,QAAQ,CAACK,QAAQ,CAACF,QAAQ,CAAC;EAC3C,CAAC,CAAC;EAEFN,OAAO,CAACI,OAAO,CAAEC,IAAI,IAAK;IACxB,IAAII,MAAM,GAAGR,cAAc,CAACM,KAAK,CAACF,IAAI,CAAC;IACvC,IAAI,CAACI,MAAM,EAAE;MACXP,KAAK,CAACQ,KAAK,CACR,oBAAmBL,IAAK,kEAC3B,CAAC;IACH;IACA,IAAIM,UAAU,GAAG,CAAC;IAClB,OAAOF,MAAM,EAAE;MACbN,QAAQ,CAACK,QAAQ,CAACC,MAAM,CAAC;MACzBA,MAAM,GAAG,UAAU,IAAIA,MAAM,GAAGA,MAAM,CAACG,iBAAiB,IAAI,IAAI,GAAG,IAAI;MAEvED,UAAU,IAAI,CAAC;MACf,IAAIA,UAAU,GAAGd,uBAAuB,EAAE;QACxCK,KAAK,CAACQ,KAAK,CACR,0DAAyDL,IAAK,GACjE,CAAC;QACD;MACF;IACF;EACF,CAAC,CAAC;EAEF,OAAOF,QAAQ;AACjB,CAAC;AAED,eAAeJ,yBAAyB","ignoreList":[]}