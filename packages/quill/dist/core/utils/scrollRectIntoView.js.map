{"version":3,"file":"scrollRectIntoView.js","names":["getParentElement","element","parentElement","getRootNode","host","getElementRect","rect","getBoundingClientRect","scaleX","Math","abs","width","offsetWidth","scaleY","height","offsetHeight","top","right","left","clientWidth","bottom","clientHeight","paddingValueToInt","value","number","parseInt","Number","isNaN","getScrollDistance","targetStart","targetEnd","scrollStart","scrollEnd","scrollPaddingStart","scrollPaddingEnd","scrollRectIntoView","root","targetRect","document","ownerDocument","current","isDocumentBody","body","bounding","window","visualViewport","documentElement","style","getComputedStyle","scrollDistanceX","scrollPaddingLeft","scrollPaddingRight","scrollDistanceY","scrollPaddingTop","scrollPaddingBottom","defaultView","scrollBy","scrollLeft","scrollTop","scrolledLeft","scrolledTop","position"],"sources":["../../../src/core/utils/scrollRectIntoView.ts"],"sourcesContent":["export type Rect = {\r\n  top: number;\r\n  right: number;\r\n  bottom: number;\r\n  left: number;\r\n};\r\n\r\nconst getParentElement = (element: Node): Element | null =>\r\n  element.parentElement || (element.getRootNode() as ShadowRoot).host || null;\r\n\r\nconst getElementRect = (element: Element): Rect => {\r\n  const rect = element.getBoundingClientRect();\r\n  const scaleX =\r\n    ('offsetWidth' in element &&\r\n      Math.abs(rect.width) / (element as HTMLElement).offsetWidth) ||\r\n    1;\r\n  const scaleY =\r\n    ('offsetHeight' in element &&\r\n      Math.abs(rect.height) / (element as HTMLElement).offsetHeight) ||\r\n    1;\r\n  return {\r\n    top: rect.top,\r\n    right: rect.left + element.clientWidth * scaleX,\r\n    bottom: rect.top + element.clientHeight * scaleY,\r\n    left: rect.left,\r\n  };\r\n};\r\n\r\nconst paddingValueToInt = (value: string) => {\r\n  const number = parseInt(value, 10);\r\n  return Number.isNaN(number) ? 0 : number;\r\n};\r\n\r\n// Follow the steps described in https://www.w3.org/TR/cssom-view-1/#element-scrolling-members,\r\n// assuming that the scroll option is set to 'nearest'.\r\nconst getScrollDistance = (\r\n  targetStart: number,\r\n  targetEnd: number,\r\n  scrollStart: number,\r\n  scrollEnd: number,\r\n  scrollPaddingStart: number,\r\n  scrollPaddingEnd: number,\r\n) => {\r\n  if (targetStart < scrollStart && targetEnd > scrollEnd) {\r\n    return 0;\r\n  }\r\n\r\n  if (targetStart < scrollStart) {\r\n    return -(scrollStart - targetStart + scrollPaddingStart);\r\n  }\r\n\r\n  if (targetEnd > scrollEnd) {\r\n    return targetEnd - targetStart > scrollEnd - scrollStart\r\n      ? targetStart + scrollPaddingStart - scrollStart\r\n      : targetEnd - scrollEnd + scrollPaddingEnd;\r\n  }\r\n  return 0;\r\n};\r\n\r\nconst scrollRectIntoView = (root: HTMLElement, targetRect: Rect) => {\r\n  const document = root.ownerDocument;\r\n\r\n  let rect = targetRect;\r\n\r\n  let current: Element | null = root;\r\n  while (current) {\r\n    const isDocumentBody: boolean = current === document.body;\r\n    const bounding = isDocumentBody\r\n      ? {\r\n          top: 0,\r\n          right:\r\n            window.visualViewport?.width ??\r\n            document.documentElement.clientWidth,\r\n          bottom:\r\n            window.visualViewport?.height ??\r\n            document.documentElement.clientHeight,\r\n          left: 0,\r\n        }\r\n      : getElementRect(current);\r\n\r\n    const style = getComputedStyle(current);\r\n    const scrollDistanceX = getScrollDistance(\r\n      rect.left,\r\n      rect.right,\r\n      bounding.left,\r\n      bounding.right,\r\n      paddingValueToInt(style.scrollPaddingLeft),\r\n      paddingValueToInt(style.scrollPaddingRight),\r\n    );\r\n    const scrollDistanceY = getScrollDistance(\r\n      rect.top,\r\n      rect.bottom,\r\n      bounding.top,\r\n      bounding.bottom,\r\n      paddingValueToInt(style.scrollPaddingTop),\r\n      paddingValueToInt(style.scrollPaddingBottom),\r\n    );\r\n    if (scrollDistanceX || scrollDistanceY) {\r\n      if (isDocumentBody) {\r\n        document.defaultView?.scrollBy(scrollDistanceX, scrollDistanceY);\r\n      } else {\r\n        const { scrollLeft, scrollTop } = current;\r\n        if (scrollDistanceY) {\r\n          current.scrollTop += scrollDistanceY;\r\n        }\r\n        if (scrollDistanceX) {\r\n          current.scrollLeft += scrollDistanceX;\r\n        }\r\n        const scrolledLeft = current.scrollLeft - scrollLeft;\r\n        const scrolledTop = current.scrollTop - scrollTop;\r\n        rect = {\r\n          left: rect.left - scrolledLeft,\r\n          top: rect.top - scrolledTop,\r\n          right: rect.right - scrolledLeft,\r\n          bottom: rect.bottom - scrolledTop,\r\n        };\r\n      }\r\n    }\r\n\r\n    current =\r\n      isDocumentBody || style.position === 'fixed'\r\n        ? null\r\n        : getParentElement(current);\r\n  }\r\n};\r\n\r\nexport default scrollRectIntoView;\r\n"],"mappings":"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","ignoreList":[]}